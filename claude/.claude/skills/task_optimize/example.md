# タスク分割の具体例 (Task Decomposition Examples)

本ドキュメントでは、AIエージェントがタスクを最適化する際の「適切」および「不適切」な粒度の例を示します。

## シナリオ：ユーザープロフィールに「SNSリンク」を追加する機能

### ✅ 適切な粒度 (Optimal - Recommended)
1つのタスクが「定義・実装・検証」のサイクルを回せる単位です。

1. **[Database]** `users` テーブルへの `sns_links` (JSONB型) カラム追加のマイグレーション。
2. **[Backend/API]** SNSリンクのバリデーションロジック実装と、更新エンドポイントの修正。
3. **[Frontend/Logic]** APIクライアントの型定義更新と、データ取得・送信ロジックの実装。
4. **[Frontend/UI]** プロフィール編集画面への入力フォーム実装とCSS調整。

---

### ❌ 不適切な粒度：大きすぎる (Too Coarse)
変更ファイル数や行数が制限（5ファイル / 200行）を超える可能性が高い状態。

- 「SNSリンク追加機能の全実装（DBからUIまで）」
  - **問題点**: 修正範囲が広すぎてレビューが困難になり、途中でエラーが発生した際のロールバックが複雑になります。

---

### ❌ 不適切な粒度：細かすぎる (Too Fine)
タスク単体で動作確認（テスト）ができず、オーバーヘッドが増大する状態。

- 「`users` テーブルにカラムを追加するSQLを作成する」
- 「バリデーション用の正規表現を記述する」
- 「保存ボタンのラベルを変更する」
  - **問題点**: 機能として不完全な状態でタスクが完了するため、CI/CDや手動テストが実行できません。

---

### ❌ 不適切な粒度：アンチパターン
- **カラム毎の分割**: 「Twitterリンクを追加」「Instagramリンクを追加」と個別にタスク化する。
  - **修正案**: 同じテーブル・同じロジックを扱うなら1つのタスク（SNSリンク追加）にまとめるべきです。
